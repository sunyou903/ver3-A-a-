<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Matchflag (브라우저 내 처리)</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif; }
    body { margin: 24px; max-width: 980px; }
    .topbar { display:flex; gap:12px; align-items:center; margin-bottom:16px; }
    .btn { padding:8px 12px; border:1px solid #ccc; border-radius:10px; cursor:pointer; background:#fff; }
    .btn:hover { background:#f7f7f7; }
    pre { white-space:pre-wrap; border:1px solid #eee; padding:10px; border-radius:8px; background:#fafafa; }
  </style>
</head>
<body>
  <div class="topbar">
    <button class="btn" onclick="location.href='./index.html'">← Nb2 페이지로</button>
    <h1 style="margin:0;">Matchflag – 다시트 교차검증</h1>
  </div>

  <p>엑셀 업로드 → A검사 실행 → 결과 로그 + (전체/불일치/일치) 엑셀 다운로드</p>

  <div style="margin:12px 0;">
    <label>파일 업로드</label>
    <input id="mfFile" type="file" accept=".xlsx,.xlsm,.xls" />
  </div>

  <button id="mfRun" class="btn">A검사 실행</button>

  <h3>로그</h3>
  <pre id="mfLog"></pre>

  <!-- SheetJS 먼저 -->
  <script src="lib/xlsx.full.min.js"></script>
  <!-- Matchflag 로직 -->
  <script defer src="matchflag.js"></script>

  <script>
  (function(){
    function appendLog(msg){
      var el = document.getElementById('mfLog');
      if (!el) return;
      el.textContent += (el.textContent ? '\n' : '') + msg;
    }
    function onFileChange(e){
      var f = e.target.files && e.target.files[0];
      if (f) {
        appendLog('"' + f.name + '" 파일을 확인했습니다.');
      } else {
        appendLog('파일 선택이 취소되었습니다.');
      }
    }
    document.addEventListener('DOMContentLoaded', function(){
      var inp = document.getElementById('mfFile');
      if (inp) inp.addEventListener('change', onFileChange);
    });
  })();
  </script>
    <script>
  (function(){
    function appendLog(msg){
      var el = document.getElementById('mfLog');
      if (!el) return;
      el.textContent += (el.textContent ? '\n' : '') + msg;
    }
  
    document.addEventListener('DOMContentLoaded', function(){
      appendLog('페이지 로드 완료. XLSX=' + (window.XLSX ? 'OK' : '미로드'));
  
      var inp = document.getElementById('mfFile');
      if (inp) {
        inp.addEventListener('change', function(e){
          var f = e.target.files && e.target.files[0];
          appendLog(f ? ('"' + f.name + '" 파일을 확인했습니다.') : '파일 선택이 취소되었습니다.');
        });
      } else {
        appendLog('mfFile 입력을 찾지 못했습니다.');
      }
  
      var btn = document.getElementById('mfRun');
      if (btn) {
        btn.addEventListener('click', function(){
          appendLog('A검사 실행 버튼 클릭을 확인했습니다.');
          if (typeof window.run === 'function') {
            appendLog('전역 run()을 호출합니다…');
            try { window.run(); } catch(e){ appendLog('run() 오류: ' + (e.message || e)); }
          } else {
            appendLog('전역 run() 함수를 찾을 수 없습니다 (JS에서 내부 바인딩만 있는 상태일 수 있음).');
          }
        });
      } else {
        appendLog('mfRun 버튼을 찾지 못했습니다.');
      }
    });
  })();
  </script>


  
</body>
</html>
